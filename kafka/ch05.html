<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter&#xA0;5.&#xA0;Writing Producers</title><link rel="stylesheet" href="epub.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body id="page"><div class="chapter" title="Chapter&#xA0;5.&#xA0;Writing Producers"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter&#xA0;5.&#xA0;Writing Producers</h1></div></div></div><p>Producers <a id="id90" class="indexterm"/>are applications that create messages and publish them to the Kafka broker for further consumption. These producers can be different in nature; for example, frontend applications, backend services, proxy applications, adapters to legacy systems, and producers for Hadoop. These producers can also be implemented in different languages such as Java<a id="id91" class="indexterm"/>, <a id="id92" class="indexterm"/>C, and <a id="id93" class="indexterm"/>Python.</p><p>In this chapter we shall be focusing on the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The Kafka API for message producers</li><li class="listitem" style="list-style-type: disc">Simple Java-based Kafka producers</li><li class="listitem" style="list-style-type: disc">Java-based Kafka producers using message partitioning</li></ul></div><p>At the end of the chapter, we will explore some of the important properties required for the Kafka producer.</p><p>Let's begin. The following diagram explains the Kafka API for message producers:</p><div class="mediaobject"><img src="graphics/7938OS_05_01.jpg" alt="Writing Producers"/></div><p>In the next few sections, we <a id="id94" class="indexterm"/>will discuss the API provided by Kafka for writing Java-based custom producers.</p><div class="section" title="The Java producer API"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec23"/>The Java producer API</h1></div></div></div><p>The following are <a id="id95" class="indexterm"/>the classes that are imported to write the Java-based basic producers for a Kafka cluster:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Producer</strong></span>: Kafka provides the <code class="literal">Producer</code> class<a id="id96" class="indexterm"/> (<code class="literal">class Producer&lt;K,V&gt;</code>) for creating messages for single or multiple topics with message<a id="id97" class="indexterm"/> partition as an optional feature. The following is the class diagram and its explanation:<div class="mediaobject"><img src="graphics/7938OS_05_02.jpg" alt="The Java producer API"/></div><p>Here, <code class="literal">Producer</code> is a type of Java generic (<a class="ulink" href="http://en.wikipedia.org/wiki/Generics_in_Java">http://en.wikipedia.org/wiki/Generics_in_Java</a>) written in Scala<a id="id98" class="indexterm"/> where<a id="id99" class="indexterm"/> we need to specify the type of parameters; <code class="literal">K</code> and <code class="literal">V</code> <a id="id100" class="indexterm"/>specify the types for the partition key and message value, respectively.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>KeyedMessage</strong></span>: The<a id="id101" class="indexterm"/> <code class="literal">KeyedMessage</code> class<a id="id102" class="indexterm"/> takes the topic name, partition key, and the message value that needs to be passed from the producer as follows:<div class="informalexample"><pre class="programlisting">class KeyedMessage[K, V](val topic: String, val key: K, val message: V) </pre></div><p>Here, <code class="literal">KeyedMessage</code> is a type of Java generic written in Scala where we need to specify the type of the parameters; <code class="literal">K</code> and <code class="literal">V</code> specify the type for the partition key and message value, respectively, and the topic is always of type <code class="literal">String</code>.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>ProducerConfig</strong></span>: The <code class="literal">ProducerConfig</code> class<a id="id103" class="indexterm"/> encapsulates the <a id="id104" class="indexterm"/>values required for establishing the connection with brokers such as the broker list, message partition class, serializer class for the message, and partition key.</li></ul></div></div></div></body></html>
