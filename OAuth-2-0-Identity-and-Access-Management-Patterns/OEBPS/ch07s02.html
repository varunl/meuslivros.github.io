<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Client credentials grant</title><link rel="stylesheet" href="epub.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body id="page"><div class="section" title="Client credentials grant"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec32"/>Client credentials grant</h1></div></div></div><p>The client credentials grant<a id="id274" class="indexterm"/> provides a specific grant flow in which the resource owner (that is, the user) is not involved.</p><p>In this grant, the client application requests an access token only with his own credentials (the identifier and secret) and uses the access token on behalf of the client application itself. In contrast, previously we used the access token on behalf of the user who authorized the request.</p><p>This grant flow is good when a service provider wants to provide some API methods that are to be used by the client application in general, instead of methods that apply to a certain resource owner, for example, API methods for statistics, maintenance, or something similar. This way of using an API is also referred to as Userless access.</p><p>Key characteristics<a id="id275" class="indexterm"/> of the client credentials grant type:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Used by confidential clients</li><li class="listitem" style="list-style-type: disc">The flow is not redirection-based</li><li class="listitem" style="list-style-type: disc">Useful in scenarios where the client application communicates directly with the service provider and not on behalf of a resource owner</li><li class="listitem" style="list-style-type: disc">The resource owner is not part of the flow</li></ul></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip22"/>Tip</h3><p>In the OAuth 2.0 Authorization Framework specification (RFC 6749), the client credentials grant is defined in section <span class="emphasis"><em>4.4</em></span>.</p></div></div><p>Let's take a look at a graphical representation of the flow, shown in the following diagram, taken from the OAuth 2.0 specification:</p><div class="mediaobject"><img src="graphics/5594OS_07_02.jpg" alt="Client credentials grant"/></div><p>The flow consists<a id="id276" class="indexterm"/> of the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The Client application makes a request to the Authorization server and performs authentication.</li><li class="listitem">The Authorization server authenticates the client based on his identifier and secret and makes a response. If the client is authenticated and the parameters supplied are valid, the client gets an access token as a response.</li></ol></div><div class="section" title="Requesting authorization"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec34"/>Requesting authorization</h2></div></div></div><p>As before, we assume that<a id="id277" class="indexterm"/> the client application is already registered with the authorization server.</p><p>The client application constructs the request address, using the specified endpoint and the parameters, for example, <code class="literal">https://api.example-service.com/oauth/authorize?grant_type=client_credentials&amp;client_id=CLIENT_ID_EXAMPLE&amp;client_secret=CLIENT_SECRET.</code>
</p><p>When constructed, the address is being executed as an HTTP POST request and if successful, the client application will get an access token in return as part of the response body. It's pretty much the same as in the password grant, but with fewer parameters.</p><p>The parameters that are used when constructing the request are the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">grant_type</code>: <a id="id278" class="indexterm"/>This is a mandatory parameter, always set to <code class="literal">client_credentials</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">scope</code>: <a id="id279" class="indexterm"/>This is an optional parameter, as in all previous cases used for specifying which parts (or types) of protected resources are to be accessed on behalf of the owner</li><li class="listitem" style="list-style-type: disc"><code class="literal">client_id</code>: <a id="id280" class="indexterm"/>This is an optional parameter used for client identification</li><li class="listitem" style="list-style-type: disc"><code class="literal">client_secret</code>:<a id="id281" class="indexterm"/> This is an optional parameter used for client identification</li></ul></div><p>Client identifier and secret are specified as optional, due to the fact that the authentication method between the client application and the authorization server may vary, but in most of the cases they are a part of the request URL.</p></div><div class="section" title="Successful authorization"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec35"/>Successful authorization</h2></div></div></div><p>If the client is authenticated<a id="id282" class="indexterm"/> and the supplied fields are successfully validated, the authorization server will respond with an access token.</p><p>The body of the response may have the following format:</p><div class="informalexample"><pre class="programlisting">{
  "access_token":"exampleAccessTokenValue123",
  "token_type":"example",
  "expires_in":3600
}</pre></div><p>Very important to note is that the client credentials grant is not issuing a refresh token. All other fields in the response are the same as in password grant and authorization code grant:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">access_token</code>: <a id="id283" class="indexterm"/>This is a mandatory parameter; its value is the actual access token the client application may store and use later</li><li class="listitem" style="list-style-type: disc"><code class="literal">token_type</code>: <a id="id284" class="indexterm"/>This is a mandatory parameter, a string representing what kind of a token the one returned in the response is</li><li class="listitem" style="list-style-type: disc"><code class="literal">expires_in</code>: <a id="id285" class="indexterm"/>This is an optional and recommended parameter that specifies the lifetime of the access token in seconds</li></ul></div></div><div class="section" title="Authorization error"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec36"/>Authorization error</h2></div></div></div><p>The error response is the same <a id="id286" class="indexterm"/>as the one in the password grant discussed previously in this chapter; we can look there for additional information when an error occurs.</p></div></div></body></html>
